<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Handling Test</title>
</head>
<body>
    <form action="loginRequest" method="post" id="loginForm">
        <fieldset>
            <p>
                ì‚¬ìš©ì ì•„ì´ë”” <input type="text" name="userId" id="userId" />
                <p id="userIdMsg"></p>
            </p>
            <p>
                ë¹„ë°€ë²ˆí˜¸ <input type="password" name="userPwd" id="userPwd" /><span id="pwdView">ğŸ”</span><span id="pwdStrong"></span>
                <p id="userPwdMsg"></p>
            </p>
            <p>
                ë¹„ë°€ë²ˆí˜¸ í™•ì¸ <input type="password" name="userPwdCheck" id="userPwdCheck" />
            </p>
            <input type="submit" value="ë¡œê·¸ì¸" />
        </fieldset>
    </form>

</body>
<script>
    let loginForm = document.getElementById("loginForm");
    let loginUserId = document.getElementById("userId");
    let loginUserPwd = document.getElementById("userPwd");
    let loginUserPwdCheck = document.getElementById("userPwdCheck");

    let idMsg = document.getElementById("userIdMsg");
    let pwdMsg = document.getElementById("userPwdMsg");
    let pwdStrong = document.getElementById("pwdStrong");
    let pwdView = document.getElementById("pwdView");
    let pwdCheckCnt = 3;

    // email ìœ íš¨ì„± ê²€ì‚¬: 'ê³„ì •@ë„ë©”ì¸.ìµœìƒìœ„ë„ë©”ì¸' í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì°¾ëŠ” ì •ê·œí‘œí˜„ì‹
    let userEmailRegex = /^[a-zA-Z0-9+-\_.]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;

    // strongRegex: ì•ˆì „ì„±ì´ ë†’ì€ ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ê°€ 14 ì ì´ìƒì´ê³  ê¸°í˜¸, ëŒ€ë¬¸ì, í…ìŠ¤íŠ¸ì˜ ì¡°í•©ì´ìˆëŠ” ê²½ìš°
    // mediumRegex: ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ê°€ 10 ì ì´ìƒì´ê³  ê¸°í˜¸, ëŒ€ë¬¸ì, í…ìŠ¤íŠ¸ê°€ ì¡°í•© ëœ ê²½ìš°
    // enoughRegex: ì•ˆì •ì„±ì´ ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ê°€ 10 ì ë¯¸ë§Œì´ê³  ê¸°í˜¸, ëŒ€ë¬¸ì, í…ìŠ¤íŠ¸ì˜ ì¡°í•©ì„ í¬í•¨í•˜ì§€ ì•ŠëŠ” ê²½ìš°
    let strongRegex = new RegExp("^(?=.{14,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\\W).*$", "g");
    let mediumRegex = new RegExp("^(?=.{10,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$", "g");
    let enoughRegex = new RegExp("(?=.{8,}).*", "g");

    let nofityMsg = (target, msg, event) => {
        target.innerHTML = msg;
        target.style.color = "Red";
        target.style.fontSize = "5pt";
        event.preventDefault();
        event.stopPropagation();
        return;
    }
    
    let idVaildation = (id, e) => {
        if(id.value.trim().length === 0) nofityMsg(idMsg, "ì•„ì´ë””ëŠ” í•„ìˆ˜ì ìœ¼ë¡œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤. ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.", e);
        else if(!userEmailRegex.test(id.value.trim())) nofityMsg(idMsg, "ì•„ì´ë””ëŠ” ì´ë©”ì¼ í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.", e);
        else idMsg.innerHTML = "";        
    }

    let pwdVaildation = (pwd, checkPwd, e) => {
        if(pwd.value.trim().length === 0) nofityMsg(pwdMsg, "ë¹„ë°€ë²ˆí˜¸ëŠ” í•„ìˆ˜ì ìœ¼ë¡œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤. ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.", e);
        else if(checkPwd.value.trim().length === 0) nofityMsg(pwdMsg, "ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í•œë²ˆ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.", e);
        else if(pwd.value.trim() !== checkPwd.value.trim()) {
            nofityMsg(pwdMsg, "ë¹„ë°€ë²ˆí˜¸ê°€ ë‹¤ë¥´ê²Œ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.", e);
            pwdCheckCnt--;
        }
        else if(!strongRegex.test(pwd.value.trim())) nofityMsg(pwdMsg, "ì…ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", e);
        else pwdMsg.innerHTML = "";
        if(pwdCheckCnt === 1) nofityMsg(pwdMsg, "ë¹„ë°€ë²ˆí˜¸ë¥¼ 3ë²ˆ ëª¨ë‘ í‹€ë¦¬ì…¨ìŠµë‹ˆë‹¤. ì ì‹œ í›„ì— ë¡œê·¸ì¸ì„ ì‹œë„í•´ì£¼ì„¸ìš”.", e);
    }

    loginUserPwd.addEventListener("change", () => {
        if(strongRegex.test(loginUserPwd.value.trim())) {
            pwdStrong.innerHTML = " ì•ˆì „ì„±ì´ ë†’ì€ ë¹„ë°€ë²ˆí˜¸ ì…ë‹ˆë‹¤.";
            pwdStrong.style.color = "green";
            pwdStrong.style.fontSize = "3pt";
        }
        else if(mediumRegex.test(loginUserPwd.value.trim())) {
            pwdStrong.innerHTML = " ì•ˆì „í•œ ë¹„ë°€ë²ˆí˜¸ ì…ë‹ˆë‹¤.";
            pwdStrong.style.color = "gray";
            pwdStrong.style.fontSize = "3pt";
        }
        else if(enoughRegex.test(loginUserPwd.value.trim())) {
            pwdStrong.innerHTML = " ì•ˆì „ì„±ì´ ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ì…ë‹ˆë‹¤.";
            pwdStrong.style.color = "orange";
            pwdStrong.style.fontSize = "3pt";
        }
        else {
            pwdStrong.innerHTML = " ì•ˆì „ì„±ì´ ë§¤ìš° ì•½í•œ ë¹„ë°€ë²ˆí˜¸ ì…ë‹ˆë‹¤.";
            pwdStrong.style.color = "Red";
            pwdStrong.style.fontSize = "3pt";
        }    
    })

    pwdView.addEventListener("click", () => {
        if(loginUserPwd.type === "password") loginUserPwd.type = "text";
        else loginUserPwd.type = "password";
    });

    loginForm.addEventListener("submit", (e) => {
        idVaildation(loginUserId, e);
        pwdVaildation(loginUserPwd, loginUserPwdCheck, e);
    });


</script>
</html>
